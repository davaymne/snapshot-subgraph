"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Throttler = void 0;
const misc_1 = require("./misc");
class Throttler {
    constructor(fn, interval) {
        this.fn = fn;
        this.interval = interval;
        this.lastAccess = -Infinity;
    }
    async call() {
        let pause = this.interval - Date.now() + this.lastAccess;
        if (pause > 0) {
            await (0, misc_1.wait)(pause);
        }
        this.lastValue = await this.fn();
        this.lastAccess = Date.now();
        return this.lastValue;
    }
    async get() {
        let now = Date.now();
        if (now - this.lastAccess < this.interval) {
            return this.lastValue;
        }
        else {
            this.lastValue = await this.fn();
            this.lastAccess = Date.now();
            return this.lastValue;
        }
    }
}
exports.Throttler = Throttler;
//# sourceMappingURL=throttler.js.map